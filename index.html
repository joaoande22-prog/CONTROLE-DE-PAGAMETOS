<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kickboxing Cobrança - WhatsApp Business</title>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:'Montserrat',sans-serif;}
body{background:linear-gradient(135deg,#000,#1a1a1a);color:#f1f1f1;padding:20px;}
header{display:flex;align-items:center;justify-content:space-between;margin-bottom:20px;flex-wrap:wrap;text-align:center;}
header img{width:70px;height:auto;border-radius:10px;}
header h1{color:#ffcc00;font-size:18px;margin-top:10px;}
h2{text-align:center;color:#ffcc00;margin-bottom:15px;}
input,select,button{padding:12px;margin:5px 0;border-radius:10px;border:none;font-size:16px;width:100%;}
input,select{background:#222;color:#fff;}
input::placeholder,select{color:#aaa;}
button{cursor:pointer;transition:0.3s;font-weight:bold;}
#btnSalvar{background:#ff5722;color:#fff;}
#btnEnviar{background:#25d366;color:#fff;margin-bottom:10px;}
button:hover{opacity:0.85;}
#formCadastro{display:flex;flex-direction:column;gap:8px;margin-bottom:20px;}
#buscaAluno{width:100%;margin:15px 0;}
#listasHorarios{display:flex;flex-direction:column;gap:20px;}
.section{flex:1;background:#111;padding:10px;border-radius:10px;box-shadow:0 2px 6px rgba(0,0,0,0.6);}
ul{list-style:none;padding:0;}
li{margin:5px 0;padding:12px;border-radius:10px;display:flex;flex-direction:column;gap:5px;background:#222;box-shadow:0 2px 6px rgba(0,0,0,0.6);}
li span{font-size:15px;font-weight:500;}
.actions{display:flex;flex-wrap:wrap;gap:6px;}
.actions button{flex:1;padding:8px;border-radius:8px;font-size:14px;font-weight:bold;color:#fff;min-width:80px;}
.actions button.whatsapp{background:#25d366;}
.actions button.pago{background:#ff9800;}
.actions button.copiar{background:#2196f3;}
.actions button.excluir{background:#f44336;}
.actions button.editar{background:#9c27b0;}
#resumoFinanceiro{font-weight:bold;margin-bottom:15px;text-align:center;}
h3{color:#ffcc00;margin-bottom:10px;text-align:center;}
h4{margin:6px 0;color:#fff;text-align:center;font-size:14px;}
@media(min-width:700px){
  body{padding:40px;}
  #formCadastro{flex-direction:row;flex-wrap:wrap;align-items:flex-start;}
  input,select,button{width:auto;flex:1;min-width:140px;}
  #btnSalvar,#btnEnviar{width:auto;}
  #listasHorarios{flex-direction:row;}
  .section{padding:15px;}
}
</style>
</head>
<body>

<header>
  <img src="Imagem do WhatsApp de 2025-10-27 à(s) 08.55.56_18b7c426.jpg" alt="Logo Kickboxing">
  <h1 id="dataHoje"></h1>
</header>

<h2>🔥 Kickboxing Cobrança - WhatsApp Business</h2>

<div id="formCadastro">
  <input type="text" id="nome" placeholder="Nome do aluno">
  <input type="text" id="telefone" placeholder="Telefone (somente números)">
  <input type="number" id="valor" placeholder="Valor da mensalidade">
  <select id="horario">
    <option value="7">7:00</option>
    <option value="8">8:00</option>
  </select>
  <button id="btnSalvar">💾 Salvar / Editar</button>
</div>

<input type="text" id="buscaAluno" placeholder="🔍 Buscar aluno...">
<div id="resumoFinanceiro">🔴 Pendentes: R$0.00 | 🟢 Pagos: R$0.00</div>

<div id="listasHorarios">
  <div class="section">
    <h3>🕖 Horário 7:00</h3>
    <h4>🟢 Pendentes</h4>
    <ul id="listaPendentes7"></ul>
    <h4>🔴 Pagos</h4>
    <ul id="listaPagos7"></ul>
  </div>
  <div class="section">
    <h3>🕗 Horário 8:00</h3>
    <h4>🟢 Pendentes</h4>
    <ul id="listaPendentes8"></ul>
    <h4>🔴 Pagos</h4>
    <ul id="listaPagos8"></ul>
  </div>
</div>

<script>
// === DATA ===
function atualizarCabecalhoData(){
  const hoje=new Date();
  const op={weekday:'long',year:'numeric',month:'long',day:'numeric'};
  document.getElementById("dataHoje").innerText=hoje.toLocaleDateString('pt-BR',op);
}

// === MENSAGENS ALEATÓRIAS ===
const mensagens = [
  "Oi [NOME]! Lembrando do pagamento da mensalidade 💪🔥",
  "Fala [NOME]! Bora acertar a mensalidade pra continuar firme no kickboxing 🥊",
  "Ei [NOME], tudo bem? Só lembrando da mensalidade desse mês 😄",
  "Olá [NOME]! Esperamos você nas aulas, não esqueça do pagamento 💥",
  "Oi [NOME]! Hora de manter a energia e acertar a mensalidade 💪"
];

// === WHATSAPP BUSINESS ===
function enviarWhatsApp(nome, telefone, valor){
  const numero = telefone.replace(/\D/g,'');
  const mensagemBase = mensagens[Math.floor(Math.random()*mensagens.length)];
  const mensagem = mensagemBase.replace("[NOME]", nome) + ` | Valor: R$${valor.toFixed(2)}`;

  const linkBusiness = `intent://send?phone=55${numero}&text=${encodeURIComponent(mensagem)}#Intent;scheme=whatsapp;package=com.whatsapp.w4b;end`;
  const linkNormal = `https://wa.me/55${numero}?text=${encodeURIComponent(mensagem)}`;

  if (/Android/i.test(navigator.userAgent)) {
    window.location.href = linkBusiness;
    setTimeout(() => window.open(linkNormal, "_blank"), 1500);
  } else {
    window.open(linkNormal, "_blank");
  }
}

// === BANCO LOCAL ===
function getAlunos(){return JSON.parse(localStorage.getItem("alunos")||"[]");}
function setAlunos(alunos){localStorage.setItem("alunos",JSON.stringify(alunos));}

// === SALVAR / EDITAR ===
let editandoId=null;
function salvarAluno(nome,telefone,valor,horario){
  const alunos=getAlunos();
  if(editandoId){
    const atualizados=alunos.map(a=>a.id===editandoId?{...a,nome,telefone,valor:valor||0,horario}:a);
    setAlunos(atualizados);
    editandoId=null;
    alert("✏️ Aluno editado!");
  }else{
    alunos.push({id:Date.now(),nome,telefone,valor:valor||0,pago:false,data:new Date().toISOString(),horario});
    setAlunos(alunos);
    alert("✅ Aluno salvo!");
  }
  limparCampos();
  carregarListas();
}

// === EDITAR ===
function editarAluno(id){
  const aluno=getAlunos().find(a=>a.id===id);
  if(!aluno)return;
  document.getElementById("nome").value=aluno.nome;
  document.getElementById("telefone").value=aluno.telefone;
  document.getElementById("valor").value=aluno.valor||"";
  document.getElementById("horario").value=aluno.horario;
  editandoId=id;
}

// === MARCAR PAGO ===
function marcarPago(id){
  const alunos=getAlunos().map(a=>a.id===id?{...a,pago:true,data:new Date().toISOString()}:a);
  setAlunos(alunos);
  carregarListas();
}

// === EXCLUIR ===
function excluirAluno(id){
  if(!confirm("❌ Tem certeza que deseja excluir este aluno?"))return;
  const alunos=getAlunos().filter(a=>a.id!==id);
  setAlunos(alunos);
  carregarListas();
}

// === COPIAR ===
function copiarTexto(texto){navigator.clipboard.writeText(texto);alert("📋 Copiado!");}

// === LISTAS ===
function carregarListas(filtro=""){
  const alunos=getAlunos();
  const pendentes7=alunos.filter(a=>!a.pago && a.horario==='7' && a.nome.toLowerCase().includes(filtro.toLowerCase()));
  const pagos7=alunos.filter(a=>a.pago && a.horario==='7' && a.nome.toLowerCase().includes(filtro.toLowerCase()));
  const pendentes8=alunos.filter(a=>!a.pago && a.horario==='8' && a.nome.toLowerCase().includes(filtro.toLowerCase()));
  const pagos8=alunos.filter(a=>a.pago && a.horario==='8' && a.nome.toLowerCase().includes(filtro.toLowerCase()));
  
  function preencherLista(lista,alunos){
    lista.innerHTML="";
    alunos.forEach(a=>{
      const li=document.createElement("li");
      li.innerHTML=`<span>${a.nome} - ${a.valor>0?`R$${a.valor.toFixed(2)}`:"(sem valor)"} | Última: ${new Date(a.data).toLocaleDateString()}</span>
      <div class="actions">
        ${!a.pago?`<button class="whatsapp" onclick="enviarWhatsApp('${a.nome}','${a.telefone}',${a.valor||0})">💬 Enviar</button>
        <button class="pago" onclick="marcarPago(${a.id})">✅ Pago</button>`:""}
        <button class="editar" onclick="editarAluno(${a.id})">✏️ Editar</button>
        <button class="copiar" onclick="copiarTexto('${a.telefone}')">📋 Copiar</button>
        <button class="excluir" onclick="excluirAluno(${a.id})">🗑 Excluir</button>
      </div>`;
      lista.appendChild(li);
    });
  }
  
  preencherLista(document.getElementById("listaPendentes7"),pendentes7);
  preencherLista(document.getElementById("listaPagos7"),pagos7);
  preencherLista(document.getElementById("listaPendentes8"),pendentes8);
  preencherLista(document.getElementById("listaPagos8"),pagos8);
  atualizarResumoFinanceiro();
}

// === RESUMO ===
function atualizarResumoFinanceiro(){
  const alunos=getAlunos();
  const totalPendentes=alunos.filter(a=>!a.pago).reduce((acc,a)=>acc+(a.valor||0),0);
  const totalPagos=alunos.filter(a=>a.pago).reduce((acc,a)=>acc+(a.valor||0),0);
  document.getElementById("resumoFinanceiro").innerText=`🔴 Pendentes: R$${totalPendentes.toFixed(2)} | 🟢 Pagos: R$${totalPagos.toFixed(2)}`;
}

// === LIMPAR ===
function limparCampos(){
  document.getElementById("nome").value="";
  document.getElementById("telefone").value="";
  document.getElementById("valor").value="";
  document.getElementById("horario").value="8";
  editandoId=null;
}

// === INICIALIZAÇÃO ===
document.addEventListener("DOMContentLoaded",()=>{
  atualizarCabecalhoData();

  document.getElementById("btnSalvar").addEventListener("click",()=>{
    const nome=document.getElementById("nome").value.trim();
    const telefone=document.getElementById("telefone").value.trim();
    const valor=parseFloat(document.getElementById("valor").value)||0;
    const horario=document.getElementById("horario").value;
    if(!nome||!telefone){alert("⚠️ Preencha nome e telefone!"); return;}
    salvarAluno(nome,telefone,valor,horario);
  });

  document.getElementById("buscaAluno").addEventListener("input",(e)=>carregarListas(e.target.value));

  carregarListas();
});
</script>
</body>
</html>
